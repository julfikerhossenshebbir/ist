<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶∞‡¶Æ‡¶ú‡¶æ‡¶® ‡¶∏‡¶Æ‡ßü‡¶∏‡ßÇ‡¶ö‡¶ø ‡ß®‡ß¶‡ß®‡ß´</title>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;500;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* ‡¶â‡¶®‡ßç‡¶®‡¶§ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤‡¶ø‡¶Ç ‡¶∂‡ßÅ‡¶∞‡ßÅ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Hind Siliguri', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a0a2b, #3a0752);
            min-height: 100vh;
            color: #ffffff;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 2rem auto;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(12px);
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
            animation: fadeIn 0.8s ease-out;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 2.5rem;
            position: relative;
        }

        .header h1 {
            font-size: 2.8rem;
            color: #ffd700;
            text-shadow: 0 3px 6px rgba(0, 0, 0, 0.4);
            margin-bottom: 1rem;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .location-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
        }

        .location-text {
            font-size: 1.4rem;
            color: #e0e0e0;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.6rem 1.2rem;
            border-radius: 30px;
            display: inline-flex;
            align-items: center;
        }

        .date-box {
            background: rgba(0, 0, 0, 0.25);
            padding: 0.8rem 1.5rem;
            border-radius: 15px;
            font-size: 1.1rem;
            margin-top: 1rem;
        }

        .times-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2.5rem 0;
        }

        .time-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0.08));
            padding: 1rem;
            border-radius: 18px;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            
        }

        .time-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #ff6b6b 0%, #ffd700 100%);
        }

        .time-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }

        .time-label {
            color: #ffd700;
            font-size: 1.6rem;
            margin-bottom: 1.2rem;
            font-weight: 600;
        }

        .time-value {
            font-size: 2.4rem;
            font-weight: 700;
            letter-spacing: 1px;
            color: #fff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .countdown-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2.5rem 0;
        }

        .countdown-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            backdrop-filter: blur(5px);
        }

        .countdown-label {
            color: #a5d6a7;
            font-size: 1.1rem;
            margin-bottom: 0.8rem;
        }

        .countdown-timer {
            font-size: 1.8rem;
            font-weight: 600;
            color: #fff;
            letter-spacing: 1px;
        }

        .progress-container {
            margin: 2.5rem 0;
            position: relative;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.8rem;
            font-size: 0.95rem;
            color: #e0e0e0;
        }

        .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #ffd700);
            width: 50%;
            transition: width 0.5s ease;
            position: relative;
        }

        .refresh-button {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 30px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
            margin: 1rem auto;
            display: block;
        }

        .refresh-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .gps-icon {
            width: 24px;
            height: 24px;
        }

        .notification {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1rem;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            transform: translateX(120%);
            animation: slideIn 0.5s forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            to { transform: translateX(0); }
        }

        @media (max-width: 768px) {
            .container {
                margin: 1rem;
                padding: 1.5rem;
            }

            .header h1 {
                font-size: 2rem;
            }

            .time-value {
                font-size: 2rem;
            }

            .countdown-timer {
                font-size: 1.4rem;
            }
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4CAF50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåô ‡¶∞‡¶Æ‡¶ú‡¶æ‡¶® ‡¶Æ‡ßÅ‡¶¨‡¶æ‡¶∞‡¶ï ‡ß®‡ß¶‡ß®‡ß´</h1>
            <div class="location-info">
                <div class="location-text" id="location">
                    <svg class="gps-icon" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 8px;">
                        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                    </svg>
                    <span id="city">‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶°‡¶ø‡¶ü‡ßá‡¶ï‡ßç‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</span>
                </div>
            </div>
            <div class="date-box" id="current-date"></div>
        </div>

        <!--<div class="progress-container">
            <div class="progress-label">
                <span>‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶∏‡¶Æ‡¶Ø‡¶º</span>
                <span id="progress-percent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>
        </div>-->

        <button class="refresh-button" onclick="startLocationTracking()">
            <svg class="gps-icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/>
            </svg>
            ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>

        <div class="times-grid">
            <div class="time-card">
                <div class="time-label">‡¶∏‡ßá‡¶π‡¶∞‡¶ø‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º</div>
                <div class="time-value" id="sehri-time">--:--:--</div>
            </div>
            <div class="time-card">
                <div class="time-label">‡¶á‡¶´‡¶§‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º</div>
                <div class="time-value" id="iftar-time">--:--:--</div>
            </div>
        </div>

        <div class="countdown-section">
            <div class="countdown-card">
                <div class="countdown-label">‡¶∏‡ßá‡¶π‡¶∞‡¶ø ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶¨‡¶æ‡¶ï‡¶ø</div>
                <div class="countdown-timer" id="sehri-countdown">--:--:--</div>
            </div>
            <div class="countdown-card">
                <div class="countdown-label">‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶¨‡¶æ‡¶ï‡¶ø</div>
                <div class="countdown-timer" id="iftar-countdown">--:--:--</div>
            </div>
        </div>
    </div>

    <script>
    const OPENCAGE_API_KEY = '308c907258b2467fbfd83d5fa6fe046c';
const ALADHAN_API_BASE = 'https://api.aladhan.com/v1/timings';
let watchId = null;
let countdownInterval = null;

document.addEventListener("DOMContentLoaded", () => {
  showLoading();
  initializeApp();
  setInterval(updateDateTime, 1000);
});

const showLoading = () => {
  const loader = document.createElement('div');
  loader.className = 'loading-overlay';
  loader.innerHTML = '<div class="loading-spinner"></div>';
  document.body.appendChild(loader);

  setTimeout(() => loader.remove(), 1500);
};

const initializeApp = () => {
  if (navigator.geolocation) {
    startLocationTracking();
  } else {
    handleGeolocationError('‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ!');
  }
  setInterval(updateProgressBar, 1000);
};

const startLocationTracking = () => {
  if (watchId) navigator.geolocation.clearWatch(watchId);

  watchId = navigator.geolocation.watchPosition(
    position => handlePositionSuccess(position),
    error => handleGeolocationError('‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ!'),
    {
      enableHighAccuracy: true,
      maximumAge: 15000,
      timeout: 10000
    }
  );
};

const handlePositionSuccess = async (position) => {
  const { latitude, longitude } = position.coords;
  updateLocation(latitude, longitude);
  updatePrayerTimes(latitude, longitude);
  showNotification('‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá!', 'success');
};

const updateLocation = async (latitude, longitude) => {
  try {
    const response = await fetch(`https://api.opencagedata.com/geocode/v1/json?q=${latitude}+${longitude}&key=${OPENCAGE_API_KEY}`);
    const data = await response.json();
    const components = data.results[0]?.components;
    const locationName = components.city || components.town || components.village || components.state || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶®';
    document.getElementById('city').textContent = locationName;
  } catch (error) {
    showNotification('‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá!', 'error');
  }
};

const updatePrayerTimes = async (latitude, longitude) => {
  try {
    const response = await fetch(`${ALADHAN_API_BASE}?latitude=${latitude}&longitude=${longitude}&method=2`);
    const data = await response.json();
    const timings = data.data.timings;
    displayPrayerTimes(timings.Fajr, timings.Maghrib);
  } catch (error) {
    showNotification('‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá!', 'error');
  }
};

const displayPrayerTimes = (sehri, iftar) => {
  document.getElementById('sehri-time').textContent = formatTime(sehri);
  document.getElementById('iftar-time').textContent = formatTime(iftar);

  if (countdownInterval) clearInterval(countdownInterval);
  countdownInterval = setInterval(() => {
    updateCountdown('sehri-countdown', sehri);
    updateCountdown('iftar-countdown', iftar);
  }, 1000);
};

const formatTime = (time) => {
  const [hour, minute] = time.split(':');
  const date = new Date();
  date.setHours(hour, minute, 0);
  return date.toLocaleTimeString('bn-BN', { hour: 'numeric', minute: '2-digit' });
};

const updateCountdown = (elementId, targetTime) => {
  const now = new Date();
  const [targetHour, targetMinute] = targetTime.split(':');
  const targetDate = new Date();
  targetDate.setHours(targetHour, targetMinute, 0, 0);

  if (targetDate < now) targetDate.setDate(targetDate.getDate() + 1);

  const diff = targetDate - now;
  const hours = Math.floor(diff / 3.6e6);
  const minutes = Math.floor((diff % 3.6e6) / 6e4);
  const seconds = Math.floor((diff % 6e4) / 1000);

  document.getElementById(elementId).textContent = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
};

const updateDateTime = () => {
  const now = new Date();
  document.getElementById('current-date').textContent = now.toLocaleDateString('bn-BN', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
};

const updateProgressBar = () => {
  const now = new Date();
  const startOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0);
  const endOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 23, 59, 59);
  const percent = ((now - startOfDay) / (endOfDay - startOfDay)) * 100;
  document.getElementById('progress').style.width = `${percent}%`;
  document.getElementById('progress-percent').textContent = `${Math.round(percent)}%`;
};

const showNotification = (message, type) => {
  const notification = document.createElement('div');
  notification.className = 'notification';
  notification.textContent = message;

  if (type === 'success') {
    notification.style.background = 'rgba(0, 128, 0, 0.9)';
  } else if (type === 'error') {
    notification.style.background = 'rgba(255, 0, 0, 0.9)';
  }

  document.body.appendChild(notification);
  setTimeout(() => notification.remove(), 3000);
};

const handleGeolocationError = (message) => {
  document.getElementById('city').textContent = '‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø';
  showNotification(message, 'error');
};
</script>
</body>
</html>
